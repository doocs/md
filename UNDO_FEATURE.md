# 撤销功能说明

## 功能概述

为 Markdown 编辑器添加了完整的撤销和重做功能，支持以下操作方式：

### 1. 快捷键操作

- **撤销**: `Ctrl + Z`
- **重做**: `Ctrl + Y`

### 2. 工具栏按钮

在编辑器顶部工具栏添加了撤销和重做按钮：

- 撤销按钮 (↶): 点击撤销上一次操作
- 重做按钮 (↷): 点击重做上一次撤销的操作

### 3. 菜单操作

在"编辑"菜单中添加了撤销和重做选项：

- 撤销 (Ctrl+Z)
- 重做 (Ctrl+Y)

### 4. 移动端浮动按钮

在移动端设备上，添加了浮动按钮组：

- 撤销按钮: 位于右下角浮动区域
- 重做按钮: 位于右下角浮动区域
- 与编辑/预览切换按钮组合显示

## 技术实现

### 1. CodeMirror 配置

在 `src/views/CodemirrorEditor.vue` 中为 CodeMirror 编辑器添加了撤销历史配置：

```javascript
const textArea = fromTextArea(dom, {
  // ... 其他配置
  undoDepth: 200, // 启用撤销历史功能，最多保存200步操作
})
```

### 2. 快捷键映射

在 `src/utils/editor.ts` 中添加了撤销和重做的快捷键映射：

```
javascript
[`${ctrlKey}-Z`]: function undo(editor) {
  editor.undo()
},

[`${ctrlKey}-Y`]: function redo(editor) {
  editor.redo()
},
```

### 3. UI 组件更新

- **EditorHeader**: 添加了撤销/重做按钮到工具栏
- **EditDropdown**: 在编辑菜单中添加了撤销/重做选项
- **CodemirrorEditor**: 为移动端添加了浮动撤销/重做按钮组

## 功能特点

1. **实时撤销**: 支持实时撤销编辑操作
2. **深度历史**: 最多保存200步操作历史
3. **多种访问方式**: 快捷键、工具栏按钮、菜单选项
4. **跨平台兼容**: 支持 Windows (Ctrl) 和 Mac (Cmd) 快捷键
5. **移动端优化**: 专门的浮动按钮组，适配移动设备
6. **用户友好**: 按钮带有工具提示显示快捷键

## 使用说明

1. **撤销操作**: 按 `Ctrl+Z` 或点击撤销按钮
2. **重做操作**: 按 `Ctrl+Y` 或点击重做按钮
3. **历史限制**: 最多可撤销200步操作
4. **自动保存**: 撤销历史与编辑器的自动保存功能独立工作

## 注意事项

- 撤销历史仅在当前会话中有效
- 关闭浏览器或刷新页面会清空撤销历史
- 撤销功能不影响文章的历史记录功能（30秒自动保存）
